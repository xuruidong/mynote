
# HTTP接口安全问题

## 防内容篡改
用户注册账户，就会得到一个appKey 和 密钥。在进行http请求时，会对所有的参数进行签名。
比如一个请求
```
curl -X "POST" "http://127.0.0.1/api/smsCode/get?appKey=9a45bc32ccccc&timestamp=1555555&apiSign=0333222dddcc" --data '{"aaa":"123"}' -H "Content-Type:application/json"
```
1 首先将所有的参数，进行排序（比如按照字母升序或者降序）
2 将排序好的参数拼成字符串
3 再拼上密钥 ？？？
4 对第3步的字符串进行签名：SHA, 得到sign
5 sign 的小写字母转成大写字母

在服务端，
1. 根据appKey获取到用户密钥
2. 将所需要的参数，进行排序
3. 计算签名
4. 对比签名

## 防重放攻击
比如黑客不篡改内容，直接重放请求。
如何确保调用的唯一性
可以使用时间戳，前一次时间是t1， 第n次还是t1,则拒绝

## 用户名密码安全

权限认证的方式： 帐号密码，认证码
### 自家产品使用用户名密码登录过程
客户端将用户名密码使用公钥加密，给服务端，服务端解密然后认证。  

但是如果每次都要传输用户名密码加解密，耗性能问题。
使用访问令牌的方式对后续所有调用进行认证：使用帐号密码认证后，服务端生成一个字符串（token）一般是uuid，给client，然后客户端使用token 来充当身份认证。
访问令牌时效性，比如是2小时，过期后，使用刷新令牌来刷新访问令牌。刷新令牌时效性，比如是14天。

### 认证码方式
比如使用微信登录csnd，用户不需要将微信用户名密码给csdn，只有一个二维码